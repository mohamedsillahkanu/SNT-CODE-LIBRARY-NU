<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Library UI</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            background-color: #1e1e2e;
            color: #ffffff;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background-color: #28293d;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            scrollbar-width: none;
            flex-shrink: 0;
        }

        .sidebar::-webkit-scrollbar {
            display: none;
        }

        .sidebar h2 {
            color: #47B5FF;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .sidebar li {
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            position: relative;
        }

        .sidebar li:hover {
            background-color: #3a3b52;
        }

        .sidebar li.active {
            background-color: #47B5FF;
            color: #000000;
        }

        .dropdown-content {
            display: none;
            margin-left: 20px;
            margin-top: 5px;
            background-color: #3a3b52;
            padding-left: 10px;
            border-radius: 5px;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-content li {
            padding: 8px;
            cursor: pointer;
        }

        .dropdown-content li:hover {
            background-color: #474761;
        }

        .content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: none;
        }

        .content::-webkit-scrollbar {
            display: none;
        }

        .topic-intro {
            background-color: #ffffff;
            color: #000;
            padding: 20px;
            border-radius: 10px;
        }

        .main-content {
            display: flex;
            height: calc(100% - 100px);
        }

        .section-buttons {
            align-self: flex-end;
            margin-bottom: 20px;
        }

        .section-buttons button {
            padding: 10px;
            margin-left: 10px;
            background-color: #474761;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .section-buttons button.active {
            background-color: #47B5FF;
            color: #000000;
        }

        .section-buttons button:hover {
            background-color: #3a3b52;
        }

        .code-section {
            background-color: #33334d;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            color: #ffffff;
        }

        .full-code {
            background-color: #ffffff;
            padding: 10px;
            border-radius: 10px;
            overflow: auto;
            margin-top: 10px;
            color: #000;
        }

        .sample-image {
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #FF6347;
            border-radius: 10px;
            padding: 10px;
            margin-top: 20px;
        }

        .sample-image img {
            width: 100%;
            height: auto;
            object-fit: cover;
            border-radius: 10px;
        }

        .copy-btn {
            padding: 8px;
            background-color: #47B5FF;
            color: #000000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .copy-btn:hover {
            background-color: #3a3b52;
            color: #ffffff;
        }

        .copy-btn.active {
            background-color: #00E0B5;
            color: #000000;
        }
    </style>
    <script>
        let currentSection = null;

        function selectSidebarItem(item, section) {
            // Highlight the selected sidebar item
            const sidebarItems = document.querySelectorAll('.sidebar li');
            sidebarItems.forEach(el => el.classList.remove('active'));
            item.classList.add('active');

            // Update URL hash
            window.location.hash = `/${section}`;
            currentSection = section;

            // Display the content based on the selection
            showCodeContent(section);
        }

        function toggleDropdown(item) {
            const dropdownContent = item.querySelector('.dropdown-content');
            if (dropdownContent) {
                dropdownContent.classList.toggle('show');
            }
        }

        function showCodeContent(section) {
            const codeSnippets = {
                "shapefile-info": {
                    "r-english": `# Load necessary libraries
library(sf)

# Load shapefile
admin <- st_read("/path/to/admin.shp")

# Print shapefile info
print(admin)`,
                    "python-english": `import geopandas as gpd

# Load shapefile
admin = gpd.read_file("/path/to/admin.shp")

# Print shapefile info
print(admin.head())`,
                    "stata-english": `* Load shapefile
shp2dta using "/path/to/admin.shp", database(admin_db) coordinates(admin_coords)

* List shapefile info
list`
                }
            };

            // Get the selected code snippet
            const selectedCode = codeSnippets[section]?.["python-english"]; // Default to Python-English if available
            const codeDisplay = document.querySelector('.full-code');
            if (selectedCode) {
                codeDisplay.innerText = selectedCode;
                document.querySelector('.code-section').style.display = 'block';
                codeDisplay.style.display = 'block';

                // Update sample image
                document.querySelector('.sample-image img').src = `https://raw.githubusercontent.com/mohamedsillahkanu/SNT-CODE-LIBRARY-NU/16df021948e18e142e103ee7e9c78ff8311005ef/${section}.png`;
                document.querySelector('.sample-image').style.display = 'block';
            } else {
                document.querySelector('.code-section').style.display = 'none';
                document.querySelector('.sample-image').style.display = 'none';
            }
        }

        function showCode(language) {
            if (!currentSection) {
                alert('Please select a section from the sidebar first.');
                return;
            }

            const codeSnippets = {
                "shapefile-info": {
                    "r-english": `# Load necessary libraries
library(sf)

# Load shapefile
admin <- st_read("/path/to/admin.shp")

# Print shapefile info
print(admin)`,
                    "python-english": `import geopandas as gpd

# Load shapefile
admin = gpd.read_file("/path/to/admin.shp")

# Print shapefile info
print(admin.head())`,
                    "stata-english": `* Load shapefile
shp2dta using "/path/to/admin.shp", database(admin_db) coordinates(admin_coords)

* List shapefile info
list`
                }
            };

            // Get the selected code snippet
            const selectedCode = codeSnippets[currentSection]?.[language.toLowerCase().replace(' ', '-')];
            const codeDisplay = document.querySelector('.full-code');
            if (selectedCode) {
                codeDisplay.innerText = selectedCode;
                document.querySelector('.code-section').style.display = 'block';
                codeDisplay.style.display = 'block';

                // Update active button styling
                const buttons = document.querySelectorAll('.section-buttons button');
                buttons.forEach(button => button.classList.remove('active'));
                const activeButton = document.querySelector(`#${language.toLowerCase().replace(' ', '-')}-btn`);
                if (activeButton) {
                    activeButton.classList.add('active');
                }
            }
        }

        function copyCode() {
            const codeToCopy = document.querySelector('.full-code').innerText;
            navigator.clipboard.writeText(codeToCopy).then(() => {
                const button = document.querySelector('.copy-btn');
                button.classList.add('active');
                setTimeout(() => {
                    button.classList.remove('active');
                }, 1000);
            });
        }
    </script>
</head>

<body>
    <div class="sidebar">
        <h2>Code Library</h2>
        <ul>
            <li onclick="toggleDropdown(this)">
                A.1 Shapefiles
                <ul class="dropdown-content">
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'shapefile-info')">Shapefile Info</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'basic-plot')">Basic Plot</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'admin-unit-overlay')">Admin Unit Overlay</li>
                </ul>
            </li>
            <li onclick="toggleDropdown(this)">
                A.2 Health Facilities
                <ul class="dropdown-content">
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'health-info')">R</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'health-info')">Python</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'health-info')">Stata</li>
                </ul>
            </li>
            <li onclick="toggleDropdown(this)">
                A.3 Routine Case Data from DHIS2
                <ul class="dropdown-content">
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'routine-case-data')">R</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'routine-case-data')">Python</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'routine-case-data')">Stata</li>
                </ul>
            </li>
        </ul>
    </div>
    <div class="content">
        <div class="topic-intro">
            <h3 class="sidebar-title">Version: 3 October 2024</h3>
            <h3 class="sidebar-title">Authors: Mohamed Sillah Kanu, Sammy Oppong, Jaline Gerardin</h3>
            <h2>Overview</h2>
            <h3>Motivation</h3>
            <p>SNT is here to stay: many NMCPs have found it useful and are continuing to embrace it and further develop it for their analytical needs. Since 2019, multiple individuals have supported the analysis portions of SNT. In most cases, individuals have built their own code in a variety of languages (Stata, R, and Python), sometimes building on others’ previous code and sometimes re-developed independently.</p>
            <p>As SNT matures, more quality assurance is needed such that NMCPs can be confident that the analysis they use to inform their decisions is of high quality regardless of the individual supporting analyst. The continued rollout of SNT also means that analysis can become more efficient if analysts are better able to build on each other’s work rather than tempted to reinvent what has already been developed. Lastly, SNT analysis can become much more accessible if there is a common resource available to help those with intermediate coding skills quickly access the collective knowledge of the SNT analyst community.</p>

            <h3>Objectives</h3>
            <p>We will build a code library for SNT analysis to:</p>
            <ul>
                <li>Improve quality and reproducibility of SNT analysis by ensuring that analysts are using similar, correct approaches.</li>
                <li>Improve efficiency of SNT analysis by minimizing duplication of effort.</li>
                <li>Promote accessibility of SNT analysis by lowering barriers to entry.</li>
            </ul>

            <h3>Target audience</h3>
            <p>Anyone doing this kind of work. We assume some basic knowledge of R, some understanding of the data, and a strong connection to the NMCP.</p>

            <h3>Scope</h3>
            <p>All analysis steps of SNT up to but not including mathematical modeling; some related analysis.</p>
        </div>
        <div class="section-buttons">
            <button onclick="showCode('R English')" id="r-english-btn">R English</button>
            <button onclick="showCode('Python English')" id="python-english-btn">Python English</button>
            <button onclick="showCode('Stata English')" id="stata-english-btn">Stata English</button>
            <button class="copy-btn" onclick="copyCode()">Copy</button>
        </div>
        <div class="code-section" style="display: none;">
            <pre class="full-code">No code selected.</pre>
        </div>
        <div class="sample-image" style="display: none;">
            <img src="https://via.placeholder.com/300x200.png?text=Select+a+Code+Language" alt="Sample Image">
        </div>
    </div>
</body>

</html>
