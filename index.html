<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Library UI</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            background-color: #1e1e2e;
            color: #ffffff;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background-color: #28293d;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            scrollbar-width: none;
            flex-shrink: 0;
        }

        .sidebar::-webkit-scrollbar {
            display: none;
        }

        .sidebar h2 {
            color: #47B5FF;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .sidebar li {
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            position: relative;
        }

        .sidebar li:hover {
            background-color: #3a3b52;
        }

        .sidebar li.active {
            background-color: #47B5FF;
            color: #000000;
        }

        .dropdown-content {
            display: none;
            margin-left: 20px;
            margin-top: 5px;
            background-color: #3a3b52;
            padding-left: 10px;
            border-radius: 5px;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-content li {
            padding: 8px;
            cursor: pointer;
        }

        .dropdown-content li:hover {
            background-color: #474761;
        }

        .content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: none;
        }

        .content::-webkit-scrollbar {
            display: none;
        }

        .topic-intro {
            background-color: #ffffff;
            color: #000;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .main-content {
            display: flex;
            height: calc(100% - 100px);
        }

        .section-buttons {
            margin-top: 20px;
        }

        .section-buttons button {
            padding: 10px;
            margin-left: 10px;
            background-color: #474761;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .section-buttons button.active {
            background-color: #47B5FF;
            color: #000000;
        }

        .section-buttons button:hover {
            background-color: #3a3b52;
        }

        .code-section {
            background-color: #33334d;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            color: #ffffff;
        }

        .full-code {
            background-color: #ffffff;
            padding: 10px;
            border-radius: 10px;
            overflow: auto;
            margin-top: 10px;
            color: #000;
        }

        .sample-image {
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #FF6347;
            border-radius: 10px;
            padding: 10px;
            margin-top: 20px;
        }

        .sample-image img {
            width: 100%;
            height: auto;
            object-fit: cover;
            border-radius: 10px;
        }

        .copy-btn {
            padding: 8px;
            background-color: #47B5FF;
            color: #000000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .copy-btn:hover {
            background-color: #3a3b52;
            color: #ffffff;
        }

        .copy-btn.active {
            background-color: #00E0B5;
            color: #000000;
        }
    </style>
    <script>
        let currentSection = null;

        function selectSidebarItem(item, section) {
            // Highlight the selected sidebar item
            const sidebarItems = document.querySelectorAll('.sidebar li');
            sidebarItems.forEach(el => el.classList.remove('active'));
            item.classList.add('active');

            // Update URL hash
            window.location.hash = `/${section}`;
            currentSection = section;

            // Hide all content sections
            const allSections = document.querySelectorAll('.content-section');
            allSections.forEach(section => section.style.display = 'none');

            // Display the selected content section
            const selectedSection = document.querySelector(`#${section}-section`);
            if (selectedSection) {
                selectedSection.style.display = 'block';
            }
        }

        function toggleDropdown(item) {
            const dropdownContent = item.querySelector('.dropdown-content');
            if (dropdownContent) {
                dropdownContent.classList.toggle('show');
            }
        }

        function showCode(language, section) {
            const codeSnippets = {
                "shapefile-info": {
                    "r-english": `# Load necessary libraries
library(sf)

# Load shapefile
admin <- st_read("/path/to/admin.shp")

# Print shapefile info
print(admin)`,
                    "python-english": `import geopandas as gpd

# Load shapefile
admin = gpd.read_file("/path/to/admin.shp")

# Print shapefile info
print(admin.head())`,
                    "stata-english": `* Load shapefile
shp2dta using "/path/to/admin.shp", database(admin_db) coordinates(admin_coords)

* List shapefile info
list`
                },
                "basic-plot": {
                    "r-english": `# Load necessary libraries
library(sf)
library(ggplot2)

# Load shapefile
admin <- st_read("/path/to/admin.shp")

# Basic plot
ggplot() +
  geom_sf(data = admin, fill = NA, color = "blue")`,
                    "python-english": `import geopandas as gpd
import matplotlib.pyplot as plt

# Load shapefile
admin = gpd.read_file("/path/to/admin.shp")

# Basic plot
admin.plot()
plt.show()`,
                    "stata-english": `* Load shapefile
shp2dta using "/path/to/admin.shp", database(admin_db) coordinates(admin_coords)

* Basic plot
spmap using admin_coords, id(_ID)`
                },
                "admin-unit-overlay": {
                    "r-english": `# Load necessary libraries
library(sf)
library(ggplot2)

# Load shapefiles
admin1 <- st_read("/path/to/admin1.shp")
admin2 <- st_read("/path/to/admin2.shp")

# Ensure both layers have the same CRS
admin1 <- st_transform(admin1, crs = st_crs(admin2))

# Plot overlays
ggplot() +
  geom_sf(data = admin1, fill = NA, color = "blue") +
  geom_sf(data = admin2, fill = NA, color = "red")`,
                    "python-english": `import geopandas as gpd
import matplotlib.pyplot as plt

# Load shapefiles
admin1 = gpd.read_file("/path/to/admin1.shp")
admin2 = gpd.read_file("/path/to/admin2.shp")

# Ensure both layers have the same CRS
admin1 = admin1.to_crs(admin2.crs)

# Plot overlays
fig, ax = plt.subplots()
admin1.plot(ax=ax, edgecolor='blue')
admin2.plot(ax=ax, edgecolor='red')
plt.title("Overlay of Admin Units")
plt.show()`,
                    "stata-english": `* Load shapefiles
shp2dta using "/path/to/admin1.shp", database(admin1_db) coordinates(admin1_coords)
shp2dta using "/path/to/admin2.shp", database(admin2_db) coordinates(admin2_coords)

* Merge shapefiles
drop _all
use admin1_db, clear
append using admin2_db

* Plot overlays
spmap using admin1_coords, id(_ID) ocolor(blue ..) || using admin2_coords, ocolor(red ..)`
                }
            };

            const codeDisplay = document.querySelector(`#${section}-code`);
            const selectedCode = codeSnippets[section]?.[language.toLowerCase().replace(' ', '-')];
            if (selectedCode && codeDisplay) {
                codeDisplay.innerText = selectedCode;
                codeDisplay.style.display = 'block';

                // Update active button styling
                const buttons = document.querySelectorAll(`#${section}-section .section-buttons button`);
                buttons.forEach(button => button.classList.remove('active'));
                const activeButton = document.querySelector(`#${language.toLowerCase().replace(' ', '-')}-btn`);
                if (activeButton) {
                    activeButton.classList.add('active');
                }
            }
        }

        function copyCode(section) {
            const codeToCopy = document.querySelector(`#${section}-code`).innerText;
            navigator.clipboard.writeText(codeToCopy).then(() => {
                const button = document.querySelector(`#${section}-copy-btn`);
                button.classList.add('active');
                setTimeout(() => {
                    button.classList.remove('active');
                }, 1000);
            });
        }
    </script>
</head>

<body>
    <div class="sidebar">
        <h2>Code Library</h2>
        <ul>
            <li onclick="toggleDropdown(this)">
                A.1 Shapefiles
                <ul class="dropdown-content">
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'shapefile-info')">Shapefile Info</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'basic-plot')">Basic Plot</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'admin-unit-overlay')">Admin Unit Overlay</li>
                </ul>
            </li>
            <li onclick="toggleDropdown(this)">
                A.2 Health Facilities
                <ul class="dropdown-content">
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'health-info')">R</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'health-info')">Python</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'health-info')">Stata</li>
                </ul>
            </li>
            <li onclick="toggleDropdown(this)">
                A.3 Routine Case Data from DHIS2
                <ul class="dropdown-content">
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'routine-case-data')">R</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'routine-case-data')">Python</li>
                    <li onclick="event.stopPropagation(); selectSidebarItem(this, 'routine-case-data')">Stata</li>
                </ul>
            </li>
        </ul>
    </div>
    <div class="content">
        <div class="topic-intro">
            <h2>Welcome to the Code Library</h2>
            <p>This code library provides a collection of useful code snippets and examples for working with geographical data, health facilities, and routine case data. You can explore various sections to learn about working with shapefiles, creating visual plots, and overlaying administrative units. Please select a topic from the sidebar to get started.</p>
        </div>

        <div id="shapefile-info-section" class="content-section" style="display: none;">
            <div class="section-buttons">
                <button onclick="showCode('R English', 'shapefile-info')" id="r-english-btn">R English</button>
                <button onclick="showCode('Python English', 'shapefile-info')" id="python-english-btn">Python English</button>
                <button onclick="showCode('Stata English', 'shapefile-info')" id="stata-english-btn">Stata English</button>
                <button class="copy-btn" id="shapefile-info-copy-btn" onclick="copyCode('shapefile-info')">Copy</button>
            </div>
            <div class="code-section">
                <pre id="shapefile-info-code" class="full-code">No code selected.</pre>
            </div>
            <div class="sample-image">
                <img src="https://via.placeholder.com/300x200.png?text=Select+a+Code+Language" alt="Sample Image">
            </div>
        </div>

        <!-- Add more content sections for each sidebar item (e.g., basic-plot-section, admin-unit-overlay-section) -->
        <div id="basic-plot-section" class="content-section" style="display: none;">
            <div class="section-buttons">
                <button onclick="showCode('R English', 'basic-plot')" id="r-english-btn">R English</button>
                <button onclick="showCode('Python English', 'basic-plot')" id="python-english-btn">Python English</button>
                <button onclick="showCode('Stata English', 'basic-plot')" id="stata-english-btn">Stata English</button>
                <button class="copy-btn" id="basic-plot-copy-btn" onclick="copyCode('basic-plot')">Copy</button>
            </div>
            <div class="code-section">
                <pre id="basic-plot-code" class="full-code">No code selected.</pre>
            </div>
            <div class="sample-image">
                <img src="https://via.placeholder.com/300x200.png?text=Select+a+Code+Language" alt="Sample Image">
            </div>
        </div>

        <!-- Add more content sections similarly for each button in the sidebar -->
    </div>
</body>

</html>
